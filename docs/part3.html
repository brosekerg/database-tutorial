<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>part3.md</title><style type='text/css'>html {overflow-x: initial !important;}.CodeMirror { height: auto; }
.CodeMirror-scroll { overflow-y: hidden; overflow-x: auto; }
.CodeMirror-lines { padding: 4px 0px; }
.CodeMirror pre { }
.CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler { background-color: white; }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background-color: rgb(247, 247, 247); white-space: nowrap; }
.CodeMirror-linenumbers { }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.CodeMirror div.CodeMirror-cursor { border-left: 1px solid black; z-index: 3; }
.CodeMirror div.CodeMirror-secondarycursor { border-left: 1px solid silver; }
.CodeMirror.cm-keymap-fat-cursor div.CodeMirror-cursor { width: auto; border: 0px; background: rgb(119, 238, 119); z-index: 1; }
.CodeMirror div.CodeMirror-cursor.CodeMirror-overwrite { }
.cm-tab { display: inline-block; }
.cm-s-typora-default .cm-header, .cm-s-typora-default .cm-property { color: rgb(217, 79, 138); }
.cm-s-typora-default pre.cm-header1:not(.cm-atom) :not(.cm-overlay) { font-size: 2rem; line-height: 2rem; }
.cm-s-typora-default pre.cm-header2:not(.cm-atom) :not(.cm-overlay) { font-size: 1.4rem; line-height: 1.4rem; }
.cm-s-typora-default .cm-atom, .cm-s-typora-default .cm-number { color: rgb(149, 132, 134); }
.cm-s-typora-default .cm-table-row, .cm-s-typora-default .cm-block-start { font-family: monospace; }
.cm-s-typora-default .cm-comment, .cm-s-typora-default .cm-code { color: rgb(74, 90, 159); font-family: monospace; }
.cm-s-typora-default .cm-tag { color: rgb(169, 68, 66); }
.cm-s-typora-default .cm-string { color: rgb(126, 134, 169); }
.cm-s-typora-default .cm-link { color: rgb(196, 122, 15); text-decoration: underline; }
.cm-s-typora-default .cm-variable-2, .cm-s-typora-default .cm-variable-1 { color: inherit; }
.cm-s-typora-default .cm-overlay { font-family: monospace; }
.CodeMirror.cm-s-typora-default div.CodeMirror-cursor { border-left: 3px solid rgb(228, 98, 154); }
.cm-s-typora-default .CodeMirror-activeline-background { left: -60px; right: -30px; background: rgba(204, 204, 204, 0.2); }
.cm-s-typora-default .CodeMirror-gutters { border-right: none; background-color: inherit; }
.cm-s-typora-default .cm-trailing-space-new-line::after, .cm-startspace::after, .cm-starttab .cm-tab::after { content: "•"; position: absolute; left: 0px; opacity: 0; font-family: LetterGothicStd, monospace; }
.os-windows .cm-startspace::after, .os-windows .cm-starttab .cm-tab::after { left: -0.1em; }
.cm-starttab .cm-tab::after { content: " "; }
.cm-startspace, .cm-tab, .cm-starttab, .cm-trailing-space-a, .cm-trailing-space-b, .cm-trailing-space-new-line { font-family: monospace; position: relative; }
.cm-s-typora-default .cm-trailing-space-new-line::after { content: "↓"; opacity: 0.3; }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: black; }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-property { color: black; }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: blue; }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: bold; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: rgb(255, 0, 0); }
.cm-invalidchar { color: rgb(255, 0, 0); }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { margin-bottom: -30px; margin-right: -30px; padding-bottom: 30px; padding-right: 30px; height: 100%; outline: none; position: relative; box-sizing: content-box; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-vscrollbar, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler { position: absolute; z-index: 6; display: none; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow-x: hidden; overflow-y: scroll; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow-y: hidden; overflow-x: scroll; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 30px; z-index: 3; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: none !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: transparent; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; word-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { word-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-widget { }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.CodeMirror-selected { background: rgb(217, 217, 217); }
.CodeMirror-focused .CodeMirror-selected { background: rgb(215, 212, 240); }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
.CodeMirror span { }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}
.CodeMirror-lint-markers { width: 16px; }
.CodeMirror-lint-tooltip { background-color: infobackground; border: 1px solid black; border-radius: 4px; color: infotext; font-family: monospace; overflow: hidden; padding: 2px 5px; position: fixed; white-space: pre-wrap; z-index: 10000; max-width: 600px; opacity: 0; transition: opacity 0.4s; font-size: 0.8em; }
.CodeMirror-lint-mark-error, .CodeMirror-lint-mark-warning { background-position: left bottom; background-repeat: repeat-x; }
.CodeMirror-lint-mark-error { background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAYAAAC09K7GAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sJDw4cOCW1/KIAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAHElEQVQI12NggIL/DAz/GdA5/xkY/qPKMDAwAADLZwf5rvm+LQAAAABJRU5ErkJggg=="); }
.CodeMirror-lint-marker-error, .CodeMirror-lint-marker-warning { background-position: center center; background-repeat: no-repeat; cursor: pointer; display: inline-block; height: 16px; width: 16px; vertical-align: middle; position: relative; }
.CodeMirror-lint-message-error, .CodeMirror-lint-message-warning { padding-left: 18px; background-position: left top; background-repeat: no-repeat; }
.CodeMirror-lint-marker-error, .CodeMirror-lint-message-error { background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAHlBMVEW7AAC7AACxAAC7AAC7AAAAAAC4AAC5AAD///+7AAAUdclpAAAABnRSTlMXnORSiwCK0ZKSAAAATUlEQVR42mWPOQ7AQAgDuQLx/z8csYRmPRIFIwRGnosRrpamvkKi0FTIiMASR3hhKW+hAN6/tIWhu9PDWiTGNEkTtIOucA5Oyr9ckPgAWm0GPBog6v4AAAAASUVORK5CYII="); }
.CodeMirror-lint-marker-warning, .CodeMirror-lint-message-warning { background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAANlBMVEX/uwDvrwD/uwD/uwD/uwD/uwD/uwD/uwD/uwD6twD/uwAAAADurwD2tQD7uAD+ugAAAAD/uwDhmeTRAAAADHRSTlMJ8mN1EYcbmiixgACm7WbuAAAAVklEQVR42n3PUQqAIBBFUU1LLc3u/jdbOJoW1P08DA9Gba8+YWJ6gNJoNYIBzAA2chBth5kLmG9YUoG0NHAUwFXwO9LuBQL1giCQb8gC9Oro2vp5rncCIY8L8uEx5ZkAAAAASUVORK5CYII="); }
.CodeMirror-lint-marker-multiple { background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAMAAADzjKfhAAAACVBMVEUAAAAAAAC/v7914kyHAAAAAXRSTlMAQObYZgAAACNJREFUeNo1ioEJAAAIwmz/H90iFFSGJgFMe3gaLZ0od+9/AQZ0ADosbYraAAAAAElFTkSuQmCC"); background-repeat: no-repeat; background-position: right bottom; width: 100%; height: 100%; }


:root { --bg-color: #ffffff; --text-color: #333333; --code-block-bg-color: inherit; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; }
body { margin: 0px; padding: 0px; height: auto; bottom: 0px; top: 0px; left: 0px; right: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { background: rgb(181, 214, 252); text-shadow: none; }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; word-wrap: break-word; position: relative; padding-bottom: 70px; white-space: pre-wrap; overflow-x: visible; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
.typora-export #write { margin: 0px auto; }
#write > p:first-child, #write > ul:first-child, #write > ol:first-child, #write > pre:first-child, #write > blockquote:first-child, #write > div:first-child, #write > table:first-child { margin-top: 30px; }
#write li > table:first-child { margin-top: -20px; }
img { max-width: 100%; vertical-align: middle; }
input, button, select, textarea { color: inherit; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
::before, ::after, * { box-sizing: border-box; }
#write p, #write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write div, #write pre { width: inherit; }
#write p, #write h1, #write h2, #write h3, #write h4, #write h5, #write h6 { position: relative; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
p { -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; }
.typora-export p { white-space: normal; }
.mathjax-block { margin-top: 0px; margin-bottom: 0px; -webkit-margin-before: 0rem; -webkit-margin-after: 0rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: bold; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; margin: 4px 0px 0px; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 80px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
pre { white-space: pre-wrap; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: var(--code-block-bg-color); position: relative !important; }
.md-diagram-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
.md-fences .CodeMirror.CodeMirror-wrap { top: -1.6em; margin-bottom: -1.6em; }
.md-fences.mock-cm { white-space: pre-wrap; }
.show-fences-line-number .md-fences { padding-left: 0px; }
.show-fences-line-number .md-fences.mock-cm { padding-left: 40px; }
.footnotes { opacity: 0.8; font-size: 0.9rem; padding-top: 1em; padding-bottom: 1em; }
.footnotes + .footnotes { margin-top: -1em; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: transparent; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: normal; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li p, li .mathjax-block { margin: 0.5rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; }
@media print {
  html, body { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  h1, h2, h3, h4, h5, h6 { break-after: avoid-page; orphans: 2; }
  p { orphans: 4; }
  html.blink-to-pdf { font-size: 13px; }
  .typora-export #write { padding-left: 1cm; padding-right: 1cm; padding-bottom: 0px; break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  @page { margin: 20mm 0mm; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 2.86rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p .md-image:only-child { display: inline-block; width: 100%; text-align: center; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.mathjax-block { white-space: pre; overflow: hidden; width: 100%; }
p + .mathjax-block { margin-top: -1.143rem; }
.mathjax-block:not(:empty)::after { display: none; }
[contenteditable="true"]:active, [contenteditable="true"]:focus { outline: none; box-shadow: none; }
.task-list { list-style-type: none; }
.task-list-item { position: relative; padding-left: 1em; }
.task-list-item input { position: absolute; top: 0px; left: 0px; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc::after, .md-toc-content::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); text-decoration: none; }
.md-toc-inner:hover { }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: bold; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
.md-tag { opacity: 0.5; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.8; font-family: monospace; }
code { text-align: left; }
h1 .md-tag, h2 .md-tag, h3 .md-tag, h4 .md-tag, h5 .md-tag, h6 .md-tag { font-weight: initial; opacity: 0.35; }
a.md-print-anchor { border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: none !important; background: transparent !important; text-decoration: initial !important; text-shadow: initial !important; }
.md-inline-math .MathJax_SVG .noError { display: none !important; }
.mathjax-block .MathJax_SVG_Display { text-align: center; margin: 1em 0em; position: relative; text-indent: 0px; max-width: none; max-height: none; min-height: 0px; min-width: 100%; width: auto; display: block !important; }
.MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display { width: auto; margin: inherit; display: inline-block !important; }
.MathJax_SVG .MJX-monospace { font-family: monospace; }
.MathJax_SVG .MJX-sans-serif { font-family: sans-serif; }
.MathJax_SVG { display: inline; font-style: normal; font-weight: normal; line-height: normal; zoom: 90%; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; }
.MathJax_SVG * { transition: none; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; }


:root { --side-bar-bg-color: #fafafa; --control-text-color: #777; }
@font-face { font-family: "Open Sans"; font-style: normal; font-weight: normal; src: local("Open Sans Regular"), url("./github/400.woff") format("woff"); }
@font-face { font-family: "Open Sans"; font-style: italic; font-weight: normal; src: local("Open Sans Italic"), url("./github/400i.woff") format("woff"); }
@font-face { font-family: "Open Sans"; font-style: normal; font-weight: bold; src: local("Open Sans Bold"), url("./github/700.woff") format("woff"); }
@font-face { font-family: "Open Sans"; font-style: italic; font-weight: bold; src: local("Open Sans Bold Italic"), url("./github/700i.woff") format("woff"); }
html { font-size: 16px; }
body { font-family: "Open Sans", "Clear Sans", "Helvetica Neue", Helvetica, Arial, sans-serif; color: rgb(51, 51, 51); line-height: 1.6; }
#write { max-width: 860px; margin: 0px auto; padding: 20px 30px 100px; }
#write > ul:first-child, #write > ol:first-child { margin-top: 30px; }
body > :first-child { margin-top: 0px !important; }
body > :last-child { margin-bottom: 0px !important; }
a { color: rgb(65, 131, 196); }
h1, h2, h3, h4, h5, h6 { position: relative; margin-top: 1rem; margin-bottom: 1rem; font-weight: bold; line-height: 1.4; cursor: text; }
h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor { text-decoration: none; }
h1 tt, h1 code { font-size: inherit; }
h2 tt, h2 code { font-size: inherit; }
h3 tt, h3 code { font-size: inherit; }
h4 tt, h4 code { font-size: inherit; }
h5 tt, h5 code { font-size: inherit; }
h6 tt, h6 code { font-size: inherit; }
h1 { padding-bottom: 0.3em; font-size: 2.25em; line-height: 1.2; border-bottom: 1px solid rgb(238, 238, 238); }
h2 { padding-bottom: 0.3em; font-size: 1.75em; line-height: 1.225; border-bottom: 1px solid rgb(238, 238, 238); }
h3 { font-size: 1.5em; line-height: 1.43; }
h4 { font-size: 1.25em; }
h5 { font-size: 1em; }
h6 { font-size: 1em; color: rgb(119, 119, 119); }
p, blockquote, ul, ol, dl, table { margin: 0.8em 0px; }
li > ol, li > ul { margin: 0px; }
hr { height: 4px; padding: 0px; margin: 16px 0px; background-color: rgb(231, 231, 231); border-width: 0px 0px 1px; border-style: none none solid; border-top-color: initial; border-right-color: initial; border-left-color: initial; border-image: initial; overflow: hidden; box-sizing: content-box; border-bottom-color: rgb(221, 221, 221); }
body > h2:first-child { margin-top: 0px; padding-top: 0px; }
body > h1:first-child { margin-top: 0px; padding-top: 0px; }
body > h1:first-child + h2 { margin-top: 0px; padding-top: 0px; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child { margin-top: 0px; padding-top: 0px; }
a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 { margin-top: 0px; padding-top: 0px; }
h1 p, h2 p, h3 p, h4 p, h5 p, h6 p { margin-top: 0px; }
li p.first { display: inline-block; }
ul, ol { padding-left: 30px; }
ul:first-child, ol:first-child { margin-top: 0px; }
ul:last-child, ol:last-child { margin-bottom: 0px; }
blockquote { border-left: 4px solid rgb(221, 221, 221); padding: 0px 15px; color: rgb(119, 119, 119); }
blockquote blockquote { padding-right: 0px; }
table { padding: 0px; word-break: initial; }
table tr { border-top: 1px solid rgb(204, 204, 204); margin: 0px; padding: 0px; }
table tr:nth-child(2n) { background-color: rgb(248, 248, 248); }
table tr th { font-weight: bold; border: 1px solid rgb(204, 204, 204); text-align: left; margin: 0px; padding: 6px 13px; }
table tr td { border: 1px solid rgb(204, 204, 204); text-align: left; margin: 0px; padding: 6px 13px; }
table tr th:first-child, table tr td:first-child { margin-top: 0px; }
table tr th:last-child, table tr td:last-child { margin-bottom: 0px; }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); }
.md-fences, code, tt { border: 1px solid rgb(221, 221, 221); background-color: rgb(248, 248, 248); border-radius: 3px; font-family: Consolas, "Liberation Mono", Courier, monospace; padding: 2px 4px 0px; font-size: 0.9em; }
.md-fences { margin-bottom: 15px; margin-top: 15px; padding: 8px 1em 6px; }
.task-list { padding-left: 0px; }
.task-list-item { padding-left: 32px; }
.task-list-item input { top: 3px; left: 8px; }
@media screen and (min-width: 914px) {
}
@media print {
  html { font-size: 13px; }
  table, pre { break-inside: avoid; }
  pre { word-wrap: break-word; }
}
.md-fences { background-color: rgb(248, 248, 248); }
#write pre.md-meta-block { padding: 1rem; font-size: 85%; line-height: 1.45; background-color: rgb(247, 247, 247); border: 0px; border-radius: 3px; color: rgb(119, 119, 119); margin-top: 0px !important; }
.mathjax-block > .code-tooltip { bottom: 0.375rem; }
#write > h3.md-focus::before { left: -1.5625rem; top: 0.375rem; }
#write > h4.md-focus::before { left: -1.5625rem; top: 0.285714rem; }
#write > h5.md-focus::before { left: -1.5625rem; top: 0.285714rem; }
#write > h6.md-focus::before { left: -1.5625rem; top: 0.285714rem; }
.md-image > .md-meta { border: 1px solid rgb(221, 221, 221); border-radius: 3px; font-family: Consolas, "Liberation Mono", Courier, monospace; padding: 2px 4px 0px; font-size: 0.9em; color: inherit; }
.md-tag { color: inherit; }
.md-toc { margin-top: 20px; padding-bottom: 20px; }
.sidebar-tabs { border-bottom: none; }
#typora-quick-open { border: 1px solid rgb(221, 221, 221); background-color: rgb(248, 248, 248); }
#typora-quick-open-item { background-color: rgb(250, 250, 250); border-color: rgb(254, 254, 254) rgb(229, 229, 229) rgb(229, 229, 229) rgb(238, 238, 238); border-style: solid; border-width: 1px; }
#md-notification::before { top: 10px; }
.on-focus-mode blockquote { border-left-color: rgba(85, 85, 85, 0.12); }
header, .context-menu, .megamenu-content, footer { font-family: "Segoe UI", Arial, sans-serif; }
.file-node-content:hover .file-node-icon, .file-node-content:hover .file-node-open-state { visibility: visible; }
.mac-seamless-mode #typora-sidebar { background-color: var(--side-bar-bg-color); }






</style>
</head>
<body class='typora-export' >
<div  id='write'  class = 'is-node'><h1><a name='header-n0' class='md-header-anchor '></a>Databases in Context: A Just-in-Time Tutorial, Part 3</h1><p><a href='https://www.linkedin.com/in/steve-mattingly-aab8064a'>Steve Mattingly</a>, Assistant Professor of Computer Science, <a href='https://www.dewv.edu'>Davis &amp; Elkins College</a>.</p><p><em>Databases in Context: A Just-in-Time Tutorial</em> by Stephen S. Mattingly is licensed under a <a href='http://creativecommons.org/licenses/by-sa/4.0/'>Creative Commons Attribution-ShareAlike 4.0 International License</a>. <img src='https://i.creativecommons.org/l/by-sa/4.0/80x15.png' alt='Creative Commons Attribution-ShareAlike 4.0 International License' /></p><hr /><p>Learn more about Open Educational Resources at <a href='http://www.unesco.org/new/en/communication-and-information/access-to-knowledge/open-educational-resources/'>UNESCO</a>. <img src='http://www.unesco.org/new/typo3temp/pics/5d3118e041.jpg' alt='UNESCO Open Educational Resources logo' /></p><hr /><p><a href='#header-n279'>Contents</a></p><hr /><h2><a name='header-n13' class='md-header-anchor '></a>Joining tables</h2><p>Normalization prevents data anomalies, but at a cost. Retrieving data is now more complicated, and often requires more resources.</p><p>The naïve unnormalized table designs that you started with did not come from nowhere. They represent a typical user view of the data. After normalization, you need a way to retrieve and present the data in a way that makes sense to users. You need to write queries that <strong>join</strong> tables.</p><p>It is easy to write a query that retrieves data from multiple tables.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select student.email, visit2nf.email, academic_rank, location from student, visit2nf;                                            
+---------------------+---------------------+---------------+----------------+
| email               | email               | academic_rank | location       |
+---------------------+---------------------+---------------+----------------+
| aalbert@dewv.net    | aalbert@dewv.net    | Junior        | Albert Hall    |
| bbooth@dewv.net     | aalbert@dewv.net    | Sophomore     | Albert Hall    |
| ccadillac@dewv.net  | aalbert@dewv.net    | Junior        | Albert Hall    |
| ddavis@dewv.net     | aalbert@dewv.net    | Freshman      | Albert Hall    |
| eelkins@dewv.net    | aalbert@dewv.net    | Senior        | Albert Hall    |
| fforest@dewv.net    | aalbert@dewv.net    | Freshman      | Albert Hall    |
| ggatehouse@dewv.net | aalbert@dewv.net    | Sophomore     | Albert Hall    |
| hhermanson@dewv.net | aalbert@dewv.net    | Senior        | Albert Hall    |
| iicehouse@dewv.net  | aalbert@dewv.net    | Sophomore     | Albert Hall    |
| aalbert@dewv.net    | bbooth@dewv.net     | Junior        | Albert Hall    |
| bbooth@dewv.net     | bbooth@dewv.net     | Sophomore     | Albert Hall    |
................... (LOTS OF ROWS REMOVED TO SAVE SPACE) .....................
| iicehouse@dewv.net  | hhermanson@dewv.net | Sophomore     | Albert Hall    |
| aalbert@dewv.net    | iicehouse@dewv.net  | Junior        | Albert Hall    |
| bbooth@dewv.net     | iicehouse@dewv.net  | Sophomore     | Albert Hall    |
| ccadillac@dewv.net  | iicehouse@dewv.net  | Junior        | Albert Hall    |
| ddavis@dewv.net     | iicehouse@dewv.net  | Freshman      | Albert Hall    |
| eelkins@dewv.net    | iicehouse@dewv.net  | Senior        | Albert Hall    |
| fforest@dewv.net    | iicehouse@dewv.net  | Freshman      | Albert Hall    |
| ggatehouse@dewv.net | iicehouse@dewv.net  | Sophomore     | Albert Hall    |
| hhermanson@dewv.net | iicehouse@dewv.net  | Senior        | Albert Hall    |
| iicehouse@dewv.net  | iicehouse@dewv.net  | Sophomore     | Albert Hall    |
+---------------------+---------------------+---------------+----------------+
126 rows in set (0.00 sec)</pre><p>By listing multiple tables in the <code>FROM</code> clause, you generate the <strong>Cartesian product</strong> of the tables. The <code>student</code> table contains 9 rows, and the <code>visit2nf</code> table contains 14 rows. Their Cartesian product contains 9 times 14, or 126 rows. Each result row is a single <code>student</code> row combined with a single <code>visit2nf</code> row, and there is one result row for every possible combination.</p><p>What do these results represent? <em>Absolutely nothing meaningful.</em> It&#39;s as if you blindly shuffled the two tables together. This illustrates an important point: you can combine data in ways that make no sense. Just because a query is valid SQL, that doesn&#39;t mean it produces meaningful data. </p><h3><a name='header-n25' class='md-header-anchor '></a>Inner joins</h3><p>A join is a query that combines rows from multiple tables in a meaningful way. When a DBMS processes a join query, it begins with the Cartesian product of the tables, then filters it to remove combinations that make no sense. Here&#39;s an example.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select student.email, visit2nf.email, academic_rank, location 
    -&gt; from student, visit2nf 
    -&gt; where student.email = visit2nf.email;
+---------------------+---------------------+---------------+----------------+
| email               | email               | academic_rank | location       |
+---------------------+---------------------+---------------+----------------+
| aalbert@dewv.net    | aalbert@dewv.net    | Junior        | Albert Hall    |
| bbooth@dewv.net     | bbooth@dewv.net     | Sophomore     | Albert Hall    |
| ccadillac@dewv.net  | ccadillac@dewv.net  | Junior        | Albert Hall    |
| ccadillac@dewv.net  | ccadillac@dewv.net  | Junior        | Albert Hall    |
| ddavis@dewv.net     | ddavis@dewv.net     | Freshman      | Albert Hall    |
| ddavis@dewv.net     | ddavis@dewv.net     | Freshman      | Writing center |
| ddavis@dewv.net     | ddavis@dewv.net     | Freshman      | Albert Hall    |
| eelkins@dewv.net    | eelkins@dewv.net    | Senior        | Albert Hall    |
| fforest@dewv.net    | fforest@dewv.net    | Freshman      | Albert Hall    |
| fforest@dewv.net    | fforest@dewv.net    | Freshman      | Albert Hall    |
| ggatehouse@dewv.net | ggatehouse@dewv.net | Sophomore     | Albert Hall    |
| ggatehouse@dewv.net | ggatehouse@dewv.net | Sophomore     | Albert Hall    |
| hhermanson@dewv.net | hhermanson@dewv.net | Senior        | Albert Hall    |
| iicehouse@dewv.net  | iicehouse@dewv.net  | Sophomore     | Albert Hall    |
+---------------------+---------------------+---------------+----------------+
14 rows in set (0.01 sec)</pre><p>First, notice the syntax of <code>student.email</code> and <code>visit2nf.email</code>. When multiple tables are involved, it&#39;s possible for column names to be ambiguous because they appear in multiple tables. In these cases, you must specify which column you mean by using the table name and a dot.</p><p>The <code>WHERE</code> clause filters the Cartesian product, keeping only the rows where the <code>student</code> table email matches the <code>visit2nf</code> email. Those rows belong together-- the results make sense. In a sense, the join query follows the reference from one table to another, reversing the decomposition due to normalization.</p><p>Most often, a join matches primary key values in one table with foreign key values in another. But a join can match any column values with the same underlying domain.</p><p>The join syntax above is a good way to introduce joins, because you are already familiar with  <code>WHERE</code> clauses. Although this syntax is easier to grasp at first, you should use a newer, ANSI-standard syntax for joins. Here is the same query using ANSI join syntax.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select student.email, visit2nf.email, academic_rank, location 
    -&gt; from student inner join visit2nf 
    -&gt; on student.email = visit2nf.email;     
+---------------------+---------------------+---------------+----------------+
| email               | email               | academic_rank | location       |
+---------------------+---------------------+---------------+----------------+
| aalbert@dewv.net    | aalbert@dewv.net    | Junior        | Albert Hall    |
| bbooth@dewv.net     | bbooth@dewv.net     | Sophomore     | Albert Hall    |
| ccadillac@dewv.net  | ccadillac@dewv.net  | Junior        | Albert Hall    |
| ccadillac@dewv.net  | ccadillac@dewv.net  | Junior        | Albert Hall    |
| ddavis@dewv.net     | ddavis@dewv.net     | Freshman      | Albert Hall    |
| ddavis@dewv.net     | ddavis@dewv.net     | Freshman      | Writing center |
| ddavis@dewv.net     | ddavis@dewv.net     | Freshman      | Albert Hall    |
| eelkins@dewv.net    | eelkins@dewv.net    | Senior        | Albert Hall    |
| fforest@dewv.net    | fforest@dewv.net    | Freshman      | Albert Hall    |
| fforest@dewv.net    | fforest@dewv.net    | Freshman      | Albert Hall    |
| ggatehouse@dewv.net | ggatehouse@dewv.net | Sophomore     | Albert Hall    |
| ggatehouse@dewv.net | ggatehouse@dewv.net | Sophomore     | Albert Hall    |
| hhermanson@dewv.net | hhermanson@dewv.net | Senior        | Albert Hall    |
| iicehouse@dewv.net  | iicehouse@dewv.net  | Sophomore     | Albert Hall    |
+---------------------+---------------------+---------------+----------------+
14 rows in set (0.01 sec)</pre><p>The meaning is the same, so the results are identical. Both email columns are shown for illustration purposes, but in a real world situation you would typically list only one. Either one will work-- after all, they&#39;re the same.</p><p>An <strong>inner join</strong> is a join where all result rows contain data from both tables. This is by far the most common scenario, so inner joins are often thought of as the default type of join. In fact, you can drop the first word from the <code>INNER JOIN</code> syntax and use just <code>JOIN</code>. They mean the same thing. </p><p>Notice that you can still use a <code>WHERE</code> clause to perform further filtering of results.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select student.email, academic_rank, location 
    -&gt; from student join visit2nf 
    -&gt; on student.email = visit2nf.email 
    -&gt; where location = &#39;Writing center&#39;;
+-----------------+---------------+----------------+
| email           | academic_rank | location       |
+-----------------+---------------+----------------+
| ddavis@dewv.net | Freshman      | Writing center |
+-----------------+---------------+----------------+
1 row in set (0.00 sec)</pre><p>Where a many-to-many relationship has been decomposed into three tables, you may need to join all three. </p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select first_name, last_name, name, season  
    -&gt; from student join student_sport 
    -&gt; on student.email = student_sport.email 
    -&gt; join sport
    -&gt; on student_sport.sport_name = sport.name and student_sport.gender = sport.gender;
+------------+-----------+----------+--------+
| first_name | last_name | name     | season |
+------------+-----------+----------+--------+
| Charlie    | Cadillac  | Baseball | Spring |
| Eric       | Elkins    | Baseball | Spring |
| Bob        | Booth     | Golf     | Fall   |
| Charlie    | Cadillac  | Soccer   | Fall   |
| Debbie     | Davis     | Soccer   | Fall   |
| Debbie     | Davis     | Softball | Spring |
+------------+-----------+----------+--------+
6 rows in set (0.00 sec)</pre><p>This connects <code>student</code> to <code>student_sport</code> through matching email values, then connects those results to <code>sport</code> by matching (sport) name and (sport) gender. (Recall that <span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.577ex" viewBox="0 -806.1 500.5 1109.7" role="img" focusable="false" style="vertical-align: -0.705ex;"><defs><path stroke-width="1" id="E1-MJMAIN-7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#E1-MJMAIN-7B" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1">\lbrace</script><code>name</code>, <code>gender</code><span class="MathJax_Preview"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="-1" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.577ex" viewBox="0 -806.1 500.5 1109.7" role="img" focusable="false" style="vertical-align: -0.705ex;"><defs><path stroke-width="1" id="E2-MJMAIN-7D" d="M65 731Q65 745 68 747T88 750Q171 750 216 725T279 670Q288 649 289 635T291 501Q292 362 293 357Q306 312 345 291T417 269Q428 269 431 266T434 250T431 234T417 231Q380 231 345 210T298 157Q293 143 292 121T291 -28V-79Q291 -134 285 -156T256 -198Q202 -250 89 -250Q71 -250 68 -247T65 -230Q65 -224 65 -223T66 -218T69 -214T77 -213Q91 -213 108 -210T146 -200T183 -177T207 -139Q208 -134 209 3L210 139Q223 196 280 230Q315 247 330 250Q305 257 280 270Q225 304 212 352L210 362L209 498Q208 635 207 640Q195 680 154 696T77 713Q68 713 67 716T65 731Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#E2-MJMAIN-7D" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2">\rbrace</script> is the primary key for <code>sport</code>.)</p><h4><a name='header-n50' class='md-header-anchor '></a>Exercise set 9</h4><ol start='' ><li><p>Write a join query to list the first and last names of students, along with the purpose of each visit they have made. Sort the results by last name and then by first name.</p></li><li><p>Repeat the previous query, but list only the visits where the student achieved their purpose.</p></li><li><p>Write a join query to list the first and last name of students, along with their majors. (If a student has two majors, their name should appear in two different result rows.) </p></li><li><p>Write the join query needed to produce the following results.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>+----------------+---------+---------+-------+
| location       | cubicle | printer | color |
+----------------+---------+---------+-------+
| NLC            | A       | P1      | No    |
| NLC            | B       | P2      | Yes   |
| NLC            | C       | P2      | Yes   |
| Writing center | A       | P3      | Yes   |
| Writing center | B       | P4      | No    |
+----------------+---------+---------+-------+
5 rows in set (0.00 sec)</pre></li><li><p>Modify the three-table join example to remove the clause that matches gender values. How and why are the results different?</p></li></ol><h3><a name='header-n61' class='md-header-anchor '></a>Outer joins</h3><p>Suppose you are asked to list all student names, along with the name of their SLP instructor, if any.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select student.first_name, student.last_name, 
    -&gt; staff.first_name, staff.last_name 
    -&gt; from student inner join staff 
    -&gt; on student.slp_instructor_first_name = staff.first_name 
    -&gt; and student.slp_instructor_last_name = staff.last_name;
+------------+-----------+------------+------------+
| first_name | last_name | first_name | last_name  |
+------------+-----------+------------+------------+
| Alice      | Albert    | Sam        | Studybuddy |
| Charlie    | Cadillac  | Terry      | Tutor      |
| Gary       | Gatehouse | Terry      | Tutor      |
| Irving     | Icehouse  | Sam        | Studybuddy |
+------------+-----------+------------+------------+
4 rows in set (0.00 sec)</pre><p>This is a good start, but a quick check shows that there are 9 rows in the <code>student</code> table. What happened to the other 5 students?</p><p>An inner join returns a result row when there are matching rows in both tables. When you want to keep all rows from one of the tables, even where there is no match in the other, you need an <strong>outer join</strong>.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select student.first_name, student.last_name, 
    -&gt; staff.first_name, staff.last_name 
    -&gt; from student left outer join staff 
    -&gt; on student.slp_instructor_first_name = staff.first_name 
    -&gt; and student.slp_instructor_last_name = staff.last_name;
+------------+-----------+------------+------------+
| first_name | last_name | first_name | last_name  |
+------------+-----------+------------+------------+
| Alice      | Albert    | Sam        | Studybuddy |
| Bob        | Booth     | NULL       | NULL       |
| Charlie    | Cadillac  | Terry      | Tutor      |
| Debbie     | Davis     | NULL       | NULL       |
| Eric       | Elkins    | NULL       | NULL       |
| Frank      | Forest    | NULL       | NULL       |
| Gary       | Gatehouse | Terry      | Tutor      |
| Hannah     | Hermanson | NULL       | NULL       |
| Irving     | Icehouse  | Sam        | Studybuddy |
+------------+-----------+------------+------------+
9 rows in set (0.00 sec)</pre><p>Here, the keywords <code>LEFT OUTER JOIN</code> tell the DBMS that you want to return all rows from the table to the left (before) the keywords. So, all nine <code>student</code> rows are returned. Where there is no corresponding staff data, <code>NULL</code>s are filled in.</p><p>Changing the query to use <code>RIGHT OUTER JOIN</code> produces these results.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>+------------+-----------+------------+------------+
| first_name | last_name | first_name | last_name  |
+------------+-----------+------------+------------+
| NULL       | NULL      | Chris      | Calendar   |
| NULL       | NULL      | Edna       | Editor     |
| NULL       | NULL      | Greg       | Guardian   |
| Alice      | Albert    | Sam        | Studybuddy |
| Irving     | Icehouse  | Sam        | Studybuddy |
| Charlie    | Cadillac  | Terry      | Tutor      |
| Gary       | Gatehouse | Terry      | Tutor      |
+------------+-----------+------------+------------+
7 rows in set (0.00 sec)</pre><p>This ensures that every <code>staff</code> row is returned at least once, along with each corresponding <code>student</code> row, if any.</p><h4><a name='header-n77' class='md-header-anchor '></a>Exercise set 10</h4><ol start='' ><li><p>List the first and last name of <em>every</em> student, along with the sports that they play, if any. You only need to join two tables for this query.</p></li><li><p>List <em>every</em> team (sport and gender), along with the students that play it, as shown below. You will need to join three tables.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>+-----------------+--------+------------+-----------+
| name            | gender | first_name | last_name |
+-----------------+--------+------------+-----------+
| Baseball        | Men    | Charlie    | Cadillac  |
| Baseball        | Men    | Eric       | Elkins    |
| Basketball      | Men    | NULL       | NULL      |
| Basketball      | Women  | NULL       | NULL      |
| Cross country   | Men    | NULL       | NULL      |
| Cross country   | Women  | NULL       | NULL      |
| Golf            | Men    | Bob        | Booth     |
| Lacrosse        | Men    | NULL       | NULL      |
| Lacrosse        | Women  | NULL       | NULL      |
| Soccer          | Men    | Charlie    | Cadillac  |
| Soccer          | Women  | Debbie     | Davis     |
| Softball        | Women  | Debbie     | Davis     |
| Swimming        | Men    | NULL       | NULL      |
| Swimming        | Women  | NULL       | NULL      |
| Tennis          | Men    | NULL       | NULL      |
| Tennis          | Women  | NULL       | NULL      |
| Track and field | Men    | NULL       | NULL      |
| Track and field | Women  | NULL       | NULL      |
| Volleyball      | Women  | NULL       | NULL      |
+-----------------+--------+------------+-----------+
19 rows in set (0.01 sec)</pre></li></ol><h3><a name='header-n85' class='md-header-anchor '></a>Self joins</h3><p>Sometimes it can be useful to join a table with itself. These queries often answer questions about pairs of entities, because they put columns from two different rows of the same table into one row of results.</p><p>One obstacle is that you need a way to refer to these two different rows, and you can&#39;t just use the table name because it is the same table in both cases. You address this by giving an <strong>alias</strong> to each table in the query.</p><p>Suppose you are asked to list all college sports that have both a Men&#39;s and a Women&#39;s team. You can do this with a self join. Here is a start.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select a.name, a.gender, b.name, b.gender 
    -&gt; from sport a join sport b 
    -&gt; on a.name = b.name where a.gender &lt;&gt; b.gender;
+-----------------+--------+-----------------+--------+
| name            | gender | name            | gender |
+-----------------+--------+-----------------+--------+
| Basketball      | Men    | Basketball      | Women  |
| Basketball      | Women  | Basketball      | Men    |
| Cross country   | Men    | Cross country   | Women  |
| Cross country   | Women  | Cross country   | Men    |
| Lacrosse        | Men    | Lacrosse        | Women  |
| Lacrosse        | Women  | Lacrosse        | Men    |
| Soccer          | Men    | Soccer          | Women  |
| Soccer          | Women  | Soccer          | Men    |
| Swimming        | Men    | Swimming        | Women  |
| Swimming        | Women  | Swimming        | Men    |
| Tennis          | Men    | Tennis          | Women  |
| Tennis          | Women  | Tennis          | Men    |
| Track and field | Men    | Track and field | Women  |
| Track and field | Women  | Track and field | Men    |
+-----------------+--------+-----------------+--------+
14 rows in set (0.00 sec)
</pre><p>This uses the aliases <code>a</code> and <code>b</code> to refer to two distinct &quot;versions&quot; or hypothetical copies of the <code>sport</code> table. (More accurately, the aliases refer to two sets of rows from the table.)</p><p>It asks for the name and gender of two sports teams, call them <code>a</code> and <code>b</code>, where the sport names match but the genders do not match. (The <code>&lt;&gt;</code> symbol means &quot;is not equal to&quot;.)</p><p>This is a good start, but there is too much data returned. For example, look at the last two result rows. The next-to-last tells you that Track and field has a Men&#39;s team but also a Women&#39;s team. The last row tells you that Track and field has a Women&#39;s team but also a Men&#39;s team.</p><p>In other words, the last two result rows really represent the same fact. You asked for pairs with different genders, but the results show each pair twice: once in each &quot;direction.&quot;</p><p>The fix for this is not exactly obvious.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select a.name, a.gender, b.name, b.gender 
    -&gt; from sport a join sport b 
    -&gt; on a.name = b.name where a.gender &lt; b.gender;
+-----------------+--------+-----------------+--------+
| name            | gender | name            | gender |
+-----------------+--------+-----------------+--------+
| Basketball      | Men    | Basketball      | Women  |
| Cross country   | Men    | Cross country   | Women  |
| Lacrosse        | Men    | Lacrosse        | Women  |
| Soccer          | Men    | Soccer          | Women  |
| Swimming        | Men    | Swimming        | Women  |
| Tennis          | Men    | Tennis          | Women  |
| Track and field | Men    | Track and field | Women  |
+-----------------+--------+-----------------+--------+
7 rows in set (0.00 sec)</pre><p>Using the <code>&lt;</code> operator filters for pairs <code>a</code> and <code>b</code> where the the first gender is (alphabetically) less than the second. That is still a &quot;not equal&quot; test, but it is only true in one direction for each pair. (You would get equivalent results if you used <code>&gt;</code> instead.)</p><p>To complete your query for the requested result, you should probably display only one column: one copy of the <code>name</code> value. The other columns were included to better illustrate how the results were obtained.</p><h4><a name='header-n108' class='md-header-anchor '></a>Exercise set 11</h4><ol start='' ><li><p>Use a self join to list the names of all sports that are played in more than one season.</p></li><li><p>Use a self join to list all pairs of students who have the same SLP instructor. The results should list each pair of students only once.</p></li><li><p>Use a self join to list the name of each staff member and the name of their assistant, excluding people who are their own assistant:</p><pre class='md-fences mock-cm' style='display:block;position:relative'>+------------+------------+------------+-----------+
| first_name | last_name  | first_name | last_name |
+------------+------------+------------+-----------+
| Sam        | Studybuddy | Chris      | Calendar  |
| Terry      | Tutor      | Chris      | Calendar  |
| Edna       | Editor     | Greg       | Guardian  |
+------------+------------+------------+-----------+
3 rows in set (0.00 sec)</pre></li></ol><h2><a name='header-n116' class='md-header-anchor '></a>Processing data with aggregate functions</h2><p>SQL includes a number of <strong>aggregate functions</strong> that summarize or &quot;roll up&quot; data in table rows.</p><p>For example, if you wanted to check how many rows were in the <code>visit2nf</code> table, you would probably run <code>SELECT * FROM visit2nf;</code>, then ignore the rows and look at the count shown by MySQL&#39;s status display.</p><p>But, an aggregate function allows you to ask the question that you really wanted.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select count(*) from visit2nf;
+----------+
| count(*) |
+----------+
|       14 |
+----------+
1 row in set (0.00 sec)</pre><p>The <code>count</code> aggregate function returns the number of rows that match some criterion; the <code>*</code> criterion matches everything.</p><p>Because every row has an <code>email</code> value, the following produces the same result.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select count(email) from visit2nf;                                                                            
+--------------+
| count(email) |
+--------------+
|           14 |
+--------------+
1 row in set (0.00 sec)</pre><p>But some of those email address are duplicates, so leave them out.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select count(distinct email) from visit2nf;                                                          
+-----------------------+
| count(distinct email) |
+-----------------------+
|                     9 |
+-----------------------+
1 row in set (0.00 sec)</pre><p>You can use a <code>WHERE</code> clause with aggregate functions. This asks how many visits were made by Eric Elkins.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select count(*) from visit2nf where email = &#39;eelkins@dewv.net&#39;;
+----------+
| count(*) |
+----------+
|        1 |
+----------+
1 row in set (0.00 sec)</pre><h3><a name='header-n135' class='md-header-anchor '></a>The <code>GROUP BY</code> clause</h3><p>Suppose you want to know how many visits were made by <em>each</em> student. You could repeat the previous query with different email values, then put all that together. It&#39;s easier to group the results by email address.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select count(*) from visit2nf group by email;
+----------+
| count(*) |
+----------+
|        1 |
|        1 |
|        2 |
|        3 |
|        1 |
|        2 |
|        2 |
|        1 |
|        1 |
+----------+
9 rows in set (0.00 sec)</pre><p>This tells you that one student (email address) visited 3 times, three visited twice, and so on. But it&#39;s more helpful like this.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select email, count(*) from visit2nf group by email;                                                          
+---------------------+----------+
| email               | count(*) |
+---------------------+----------+
| aalbert@dewv.net    |        1 |
| bbooth@dewv.net     |        1 |
| ccadillac@dewv.net  |        2 |
| ddavis@dewv.net     |        3 |
| eelkins@dewv.net    |        1 |
| fforest@dewv.net    |        2 |
| ggatehouse@dewv.net |        2 |
| hhermanson@dewv.net |        1 |
| iicehouse@dewv.net  |        1 |
+---------------------+----------+
9 rows in set (0.00 sec)</pre><p>Now you know which email is on 3 visits, and so forth.</p><h4><a name='header-n144' class='md-header-anchor '></a>The <code>HAVING</code> clause</h4><p>Suppose that you were asked to list all students who have visited more than once. You can filter aggregate <em>results</em> with <code>HAVING</code>.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select email, count(*) from visit2nf group by email having count(*) &gt; 1;
+---------------------+----------+
| email               | count(*) |
+---------------------+----------+
| ccadillac@dewv.net  |        2 |
| ddavis@dewv.net     |        3 |
| fforest@dewv.net    |        2 |
| ggatehouse@dewv.net |        2 |
+---------------------+----------+
4 rows in set (0.00 sec)</pre><p>This computes the number of visits for each email address, then displays only the counts that are greater than one.</p><p>Like <code>WHERE</code>, the <code>HAVING</code> clause determines what data is displayed. The difference is that <code>WHERE</code> determines which rows <em>go into</em> the aggregate function, while <code>HAVING</code> determines which aggregate results are displayed. </p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select email, count(*) from visit2nf 
    -&gt; where email &lt;&gt; &#39;ddavis@dewv.net&#39; 
    -&gt; group by email having count(*) &gt; 1;     
+---------------------+----------+
| email               | count(*) |
+---------------------+----------+
| ccadillac@dewv.net  |        2 |
| fforest@dewv.net    |        2 |
| ggatehouse@dewv.net |        2 |
+---------------------+----------+
3 rows in set (0.00 sec)</pre><p> There are many aggregate functions besides <code>COUNT()</code>. Here are examples of the most commonly used.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>-- Use MIN() to find minimum value: who has the earliest visit on record?
mysql&gt; select email, min(check_in_time) from visit2nf;
+------------------+---------------------+
| email            | min(check_in_time)  |
+------------------+---------------------+
| aalbert@dewv.net | 2016-08-30 13:35:55 |
+------------------+---------------------+
1 row in set (0.00 sec)

-- Use MAX() to find maximum value: when was the most recent visit for each student?
mysql&gt; select email, max(check_in_time) from visit2nf group by email;                                                
+---------------------+---------------------+
| email               | max(check_in_time)  |
+---------------------+---------------------+
| aalbert@dewv.net    | 2016-08-30 15:15:05 |
| bbooth@dewv.net     | 2016-08-30 15:44:54 |
| ccadillac@dewv.net  | 2016-08-31 11:51:15 |
| ddavis@dewv.net     | 2016-08-31 16:00:06 |
| eelkins@dewv.net    | 2016-08-30 15:49:59 |
| fforest@dewv.net    | 2016-08-31 11:19:15 |
| ggatehouse@dewv.net | 2016-08-31 14:36:56 |
| hhermanson@dewv.net | 2016-08-30 15:55:55 |
| iicehouse@dewv.net  | 2016-08-30 14:56:56 |
+---------------------+---------------------+
9 rows in set (0.00 sec)

-- Use SUM() to total numeric values
mysql&gt; select location, sum(memory) from computer group by location;
+----------------+-------------+
| location       | sum(memory) |
+----------------+-------------+
| NLC            |          20 |
| Writing center |           8 |
+----------------+-------------+
2 rows in set (0.00 sec)

-- Use AVG() to compute the average of numeric values
mysql&gt; select avg(memory) from computer;
+-------------+
| avg(memory) |
+-------------+
|      5.6000 |
+-------------+
1 row in set (0.00 sec)</pre><h3><a name='header-n156' class='md-header-anchor '></a>Exercise set 12</h3><ol><li>Write a single query that lists each gender and how many sports exist for that gender.</li><li>Write a single query to list major names and the number of students who have that major. (It is okay if majors with no students are not in the results.)</li><li>Write a single query to answer this question: how many computers have less than 8GB of memory?</li><li>Write a single query to list the locations that have more than one SLP instructor.</li></ol><h2><a name='header-n157' class='md-header-anchor '></a>Subqueries and set operations</h2><p>Consider the following query.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select email from student_major 
    -&gt; where major_name = &#39;Computer Science&#39; or major_name = &#39;Philosophy&#39;;
+---------------------+
| email               |
+---------------------+
| aalbert@dewv.net    |
| bbooth@dewv.net     |
| ggatehouse@dewv.net |
| bbooth@dewv.net     |
| ddavis@dewv.net     |
+---------------------+
5 rows in set (0.00 sec)</pre><p>This is straightforward, but can become awkward if there are many different values you want to match on. The <code>IN</code> operator allows you to specify a set of values.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select email from student_major 
    -&gt; where major_name in (&#39;Computer Science&#39;, &#39;Philosophy&#39;, &#39;English&#39;);  
+---------------------+
| email               |
+---------------------+
| aalbert@dewv.net    |
| bbooth@dewv.net     |
| ggatehouse@dewv.net |
| ccadillac@dewv.net  |
| ddavis@dewv.net     |
| bbooth@dewv.net     |
| ddavis@dewv.net     |
+---------------------+
7 rows in set (0.00 sec)</pre><p>The <code>IN</code> operator can also match on sets that are produced by a <strong>subquery</strong>-- a secondary query nested within the main one.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select email from student_major where major_name = &#39;Computer Science&#39; 
    -&gt; and email in (select email from student_sport);            
+-----------------+
| email           |
+-----------------+
| bbooth@dewv.net |
+-----------------+
1 row in set (0.00 sec)</pre><p>This query lists all Computer Science majors who are athletes. The subquery (or &quot;inner&quot; query) generates all student athlete emails, then the main or &quot;outer&quot; query uses <code>IN</code> to match with emails of Computer Science majors.</p><p>Subqueries can also appear in the <code>SELECT</code> list.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select location, cubicle, memory, 
    -&gt; (select avg(memory) from computer) as &#39;average memory&#39; from computer;                          
+----------------+---------+--------+----------------+
| location       | cubicle | memory | average memory |
+----------------+---------+--------+----------------+
| NLC            | A       |      4 |         5.6000 |
| NLC            | B       |      8 |         5.6000 |
| NLC            | C       |      8 |         5.6000 |
| Writing center | A       |      4 |         5.6000 |
| Writing center | B       |      4 |         5.6000 |
+----------------+---------+--------+----------------+
5 rows in set (0.01 sec)</pre><p>This query lists each computer, its amount of memory, and the average amount of memory. Notice that <code>AS</code> is used to label one of the result columns, replacing the awkward system-generated label.</p><p>When a subquery uses a value from the main query, it is called a <strong>correlated subquery</strong>. This query is similar to the previous one, but lists the average memory for computers at that computer&#39;s location.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select location, cubicle, memory, 
    -&gt; (select avg(memory) from computer where computer.location = a.location) 
    -&gt; as &#39;location average&#39; from computer a;   
+----------------+---------+--------+------------------+
| location       | cubicle | memory | location average |
+----------------+---------+--------+------------------+
| NLC            | A       |      4 |           6.6667 |
| NLC            | B       |      8 |           6.6667 |
| NLC            | C       |      8 |           6.6667 |
| Writing center | A       |      4 |           4.0000 |
| Writing center | B       |      4 |           4.0000 |
+----------------+---------+--------+------------------+
5 rows in set (0.00 sec)</pre><p>Because the subquery is on the same table as the main query, you must use an alias for one table instance. </p><p>SQL defines a set <code>UNION</code> operator that allows you to append one query&#39;s results to another. Suppose that you wanted to list all email addresses in the database.</p><pre class='md-fences mock-cm' style='display:block;position:relative'>mysql&gt; select email from student
    -&gt; union
    -&gt; select email from staff;
+----------------------+
| email                |
+----------------------+
| aalbert@dewv.net     |
| bbooth@dewv.net      |
| ccadillac@dewv.net   |
| ddavis@dewv.net      |
| eelkins@dewv.net     |
| fforest@dewv.net     |
| ggatehouse@dewv.net  |
| hhermanson@dewv.net  |
| iicehouse@dewv.net   |
| ccalendar@dewv.net   |
| sstudybuddy@dewv.net |
| ttutor@dewv.net      |
| eeditor@dewv.net     |
| gguardian@dewv.net   |
+----------------------+
14 rows in set (0.01 sec)</pre><p>When using <code>UNION</code>, the two queries must be <strong>union compatible</strong>: they must return the same number of columns, and the corresponding columns must have the same data type.</p><h1><a name='header-n279' class='md-header-anchor '></a>Contents</h1><div class='md-toc' mdtype='toc'><p class="md-toc-content"><span class="md-toc-item md-toc-h1" data-ref="n0"><a class="md-toc-inner" style="cursor: pointer;" href="#header-n0">Databases in Context: A Just-in-Time Tutorial, Part 3</a></span><span class="md-toc-item md-toc-h2" data-ref="n13"><a class="md-toc-inner" style="cursor: pointer;" href="#header-n13">Joining tables</a></span><span class="md-toc-item md-toc-h3" data-ref="n25"><a class="md-toc-inner" style="cursor: pointer;" href="#header-n25">Inner joins</a></span><span class="md-toc-item md-toc-h4" data-ref="n50"><a class="md-toc-inner" style="cursor: pointer;" href="#header-n50">Exercise set 9</a></span><span class="md-toc-item md-toc-h3" data-ref="n61"><a class="md-toc-inner" style="cursor: pointer;" href="#header-n61">Outer joins</a></span><span class="md-toc-item md-toc-h4" data-ref="n77"><a class="md-toc-inner" style="cursor: pointer;" href="#header-n77">Exercise set 10</a></span><span class="md-toc-item md-toc-h3" data-ref="n85"><a class="md-toc-inner" style="cursor: pointer;" href="#header-n85">Self joins</a></span><span class="md-toc-item md-toc-h4" data-ref="n108"><a class="md-toc-inner" style="cursor: pointer;" href="#header-n108">Exercise set 11</a></span><span class="md-toc-item md-toc-h2" data-ref="n116"><a class="md-toc-inner" style="cursor: pointer;" href="#header-n116">Processing data with aggregate functions</a></span><span class="md-toc-item md-toc-h3" data-ref="n135"><a class="md-toc-inner" style="cursor: pointer;" href="#header-n135">The <code>GROUP BY</code> clause</a></span><span class="md-toc-item md-toc-h4" data-ref="n144"><a class="md-toc-inner" style="cursor: pointer;" href="#header-n144">The <code>HAVING</code> clause</a></span><span class="md-toc-item md-toc-h3" data-ref="n156"><a class="md-toc-inner" style="cursor: pointer;" href="#header-n156">Exercise set 12</a></span><span class="md-toc-item md-toc-h2" data-ref="n157"><a class="md-toc-inner" style="cursor: pointer;" href="#header-n157">Subqueries and set operations</a></span><span class="md-toc-item md-toc-h1" data-ref="n279"><a class="md-toc-inner" style="cursor: pointer;" href="#header-n279">Contents</a></span></p></div></div>
</body>
</html>